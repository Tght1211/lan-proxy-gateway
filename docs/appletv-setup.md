# Apple TV 网络设置指南

在 Mac 上启动 LAN Proxy Gateway 后，按以下步骤配置 Apple TV。

## 前提

- Mac 已运行 `sudo ./start.sh` 且显示启动成功
- 记下 Mac 的局域网 IP（start.sh 输出会显示，例如 `192.168.1.2`）
- Apple TV 和 Mac 连接同一个 Wi-Fi / 路由器

## 设置步骤

### 1. 进入网络设置

```
设置 → 网络
```

### 2. 选择 Wi-Fi

```
Wi-Fi → 选择你的 Wi-Fi 网络
```

如果已经连接，直接点击当前连接的网络名称进入详情。

### 3. IP 地址设置

将 **配置 IP** 改为 **手动**：

| 设置项 | 值 | 说明 |
|--------|-----|------|
| IP 地址 | `192.168.x.101` | 同网段未使用的 IP（x 和 Mac 相同） |
| 子网掩码 | `255.255.255.0` | 保持默认 |
| 路由器 | `192.168.x.2` | **Mac 的 IP** |

> 例：Mac IP 是 `192.168.1.2`，Apple TV 可设为 `192.168.1.101`，路由器填 `192.168.1.2`

### 4. DNS 设置

将 **配置 DNS** 改为 **手动**：

| 设置项 | 值 |
|--------|-----|
| DNS 服务器 | Mac 的 IP（如 `192.168.1.2`） |

点击已有的 DNS 地址进行修改，或删除后添加 Mac 的 IP。

### 5. 保存并测试

返回上一级，Apple TV 会自动应用新的网络配置。

## 验证

### 在 Apple TV 上
- 打开 **YouTube** App，播放一个视频，确认能正常加载
- 打开 **Netflix** App，确认能浏览和播放内容
- 打开 **Disney+** 或其他流媒体 App 测试

### 在 Mac 上
```bash
# 查看代理状态
./status.sh

# 查看实时日志，应能看到 Apple TV 的连接
tail -f /tmp/lan-proxy-gateway.log
```

## 恢复自动网络

停止代理网关后，Apple TV 网络需要改回去：

```
设置 → 网络 → Wi-Fi → 选择你的网络
→ 配置 IP：自动
→ 配置 DNS：自动
```

## 常见问题

### Netflix 提示地区限制 / 代理检测
Netflix 对代理检测比较严格。需要在 mihomo 管理面板（`http://Mac的IP:9090/ui`）或 `status.sh` 中切换到支持解锁流媒体的节点。不是所有节点都能解锁 Netflix，建议选择带"解锁"、"流媒体"标签的节点。

### 4K 播放卡顿 / 转圈
4K 视频需要较高的带宽（建议 25Mbps 以上）。如果播放卡顿，说明当前代理节点带宽不够，请切换到速度更快的节点。可以通过 `status.sh` 查看当前节点延迟。

### 连不上网
1. 确认 Mac 上 `./status.sh` 显示 mihomo 正在运行
2. 确认 Apple TV 的路由器和 DNS 都填了 Mac 的 IP
3. 确认 IP 地址的前三段和 Mac 相同（如都是 `192.168.1.x`）
4. 尝试在 Apple TV 上重启网络：设置 → 网络 → Wi-Fi → 关闭再打开
